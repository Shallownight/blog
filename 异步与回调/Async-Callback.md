# 异步与回调

> 异步与回调是JS学习中经常听到的名词，今天把两者弄明白。

	在多线程操作下可以实现应用的并行处理，从而以更高的CPU利用率提高整个应用程序的性能和吞吐量。
	特别是现在很多语言都支持多核并行处理技术

	作为浏览器脚本语言，JavaScript的主要用途是与用户互动，以及操作DOM。若以多线程的方式操作这些DOM，则可能出现操作的冲突。
	假设有两个线程同时操作一个DOM元素，线程1要求浏览器删除DOM，而线程2却要求修改DOM样式，这时浏览器就无法决定采用哪个线程的操作。
	当然，我们可以为浏览器引入“锁”的机制来解决这些冲突，但这会大大提高复杂性，所以 JavaScript 从诞生开始就选择了单线程执行。

	另外，因为 JavaScript 是单线程的，在某一时刻内只能执行特定的一个任务，并且会阻塞其它任务执行。
	那么对于类似I/O等耗时的任务，就没必要等待他们执行完后才继续后面的操作。
	在这些任务完成前，JavaScript完全可以往下执行其他操作，当这些耗时的任务完成后则以回调的方式执行相应处理。
	这些就是JavaScript与生俱来的特性：异步与回调。

## 异步
常常听到有评论说JS是天生异步的。开头引用的那段话解释了为什么JS使用单线程，而使用单线程，就必然要用到异步。

### 什么是异步
看到并记录了一个解释异步和回调的例子：

	我表哥要去我姑妈家帮我 拿回我的剃须刀
	他拿回来之前 我不能 刮胡子
	他拿回来之前 我可以 洗澡
	剃须刀拿回来之后 我就可以刮胡子
	洗澡和拿回我的剃须刀 是异步的
	刮胡子是拿回剃须刀的 回调callback

网上异步的资料很多，我给出的解释是：
把要等待执行的函数扔一边（扔到EventLoop中），先执行不需要等待的函数。当扔在EventLoop中的函数达到执行条件后再执行。

### 异步操作
最常见的异步是用setTimeout，Ajax也是异步的代表性操作。除此之外，还有一些异步的方法我也需要学习。
但是，我查找资料时，很多例子把回调函数和异步绑定在一起。这很容易形成：使用回调函数就是异步的观点。** 回调跟异步不是一个东西，没有依存关系，但经常绑定在一起。 **
使用setTimeout中第一个参数就是回调函数，而ajax中success等也是回调函数。

## 回调
	A callback is a function that is passed as an argument to another function and is executed after its parent function has completed.

** 回调就是一个函数被当做参数传递给另一个函数，它在父函数完成后再执行。 **
举个例子：
```
  function  a(callback){
      alert('a');
      callback();
   }
   function  b(){
       alert('b');
   }
   //调用
   a(b);
```
这就是回调，并不神秘，也不复杂。
JS中用到的回调函数内嵌回调函数多了，就会导致代码复杂难懂，称为回调地狱(callback hell)。现在有一些解决这个问题方法：Async、Promise、Generator等，需要根深入的学习。